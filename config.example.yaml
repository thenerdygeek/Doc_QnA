# ── Doc QA Tool Configuration ─────────────────────────────────
# Copy this file to config.yaml and edit the values below.
# config.yaml is gitignored — your settings won't be committed.
# ──────────────────────────────────────────────────────────────

doc_repo:
  # Path to your documentation repository (or configure from Settings UI)
  path: ""
  patterns:
  - '**/*.adoc'
  - '**/*.md'
  - '**/*.puml'
  - '**/*.pdf'
  exclude:
  - '**/build/**'
  - '**/target/**'
  - '**/node_modules/**'
  - '**/.git/**'

indexing:
  db_path: ./data/doc_qa_db
  chunk_size: 512
  chunk_overlap: 50
  min_chunk_size: 100
  # "auto" picks the best model based on system RAM:
  #   >= 12 GB RAM → nomic-ai/nomic-embed-text-v1.5 (768d, best quality)
  #   <  12 GB RAM → sentence-transformers/all-MiniLM-L6-v2 (384d, lighter)
  embedding_model: auto
  chunking_strategy: paragraph
  enable_parent_child: true
  parent_chunk_size: 1024
  child_chunk_size: 256

retrieval:
  search_mode: hybrid
  top_k: 5
  candidate_pool: 20
  min_score: 0.3
  max_chunks_per_file: 2
  rerank: true
  reranker_model: cross-encoder/ms-marco-MiniLM-L-6-v2
  max_query_length: 2000
  max_history_turns: 10
  context_reorder: true
  enable_hyde: true
  enable_query_expansion: true
  max_expansion_queries: 3

llm:
  # "cody" = Sourcegraph Cody (recommended), "ollama" = local Ollama
  primary: cody
  fallback: ollama

cody:
  # Token is read from the SRC_ACCESS_TOKEN environment variable (no need to put it here).
  # Endpoint is read from SRC_ENDPOINT env var, or defaults to https://sourcegraph.com.
  access_token_env: SRC_ACCESS_TOKEN
  endpoint: ""
  agent_binary: null
  model: anthropic::2025-01-01::claude-3.5-sonnet

ollama:
  host: http://localhost:11434
  model: qwen2.5:3b

api:
  host: 127.0.0.1
  port: 8000
  cors_origins:
  - '*'
  session_ttl: 1800

intelligence:
  enable_intent_classification: true
  intent_confidence_high: 0.85
  intent_confidence_medium: 0.65
  enable_multi_intent: true
  max_sub_queries: 3

generation:
  enable_diagrams: true
  mermaid_validation: auto
  node_script_path: scripts/validate_mermaid.mjs
  max_diagram_retries: 3
  suggest_diagrams: true

verification:
  enable_verification: true
  enable_crag: true
  confidence_threshold: 0.6
  caveat_threshold: 0.4
  max_crag_rewrites: 2
  abstain_on_low_confidence: true

feedback:
  enable_score_boost: true
  boost_max: 0.10
